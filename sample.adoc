:source-highlighter: highlight.js
:icons: font

[source, ruby]
----
class ExternalCalloutTreeProcessor < Extensions::TreeProcessor

  use_dsl

  def process(document)

    document.find_by context: :listing, style: 'source'.each do |src|

      Open3.popen3 cmd do |stdin, stdout, _, wait_thr|
        stdin.write src.source
        stdin.close

        result = []

        while (line = stdout.gets)
          result << line
        end

        result << 'Eureka'

        src.lines.replace result
        wait_thr.value

      end

    end

  end

end
----
1. test @{zwsp}5 test @5 @/result/ @6
2. this is another test @5
3. Another callout on the same line @5
4. this is a string find @/result/
5. Out of range @500


[source, json]
----
include::sample.json[]
----
. This is the line with the second name @/second_name/
. Missing string @/Wellington boot/

[source, json5]
----
{"me":  "test block"}  // <.>
----
<.> Test block


[source, shell]
----
#!/bin/bash

# example of using arguments to a script
echo "My first name is $1"
echo "My surname is $2"
echo "Total number of arguments is $#"
----
. Echo the surname @5
. Explain the total number of arguments   @/number of .+/
